# 会話LLM_仕様.md 5ファイル分割設計書

**作成日:** 2025-11-19  
**ステータス:** 分割作業途中（1/5ファイル作成済み）  
**元ファイル:** docks/仕様書/会話LLM_仕様.md（約850行）

---

## 1. 分割の目的

- ✅ ファイルサイズを管理可能な範囲に削減（各350-700行）
- ✅ 関連機能をまとめた論理的な構造
- ✅ 独立して読める文書単位

---

## 2. 5ファイル構成

### ファイル1: 会話LLM_記憶システム仕様.md（700行）
**保存先:** `docks/仕様書/会話LLM_記憶システム仕様.md`  
**ステータス:** ✅ 作成済み

**含まれるセクション:**
- セクション4（4.1-4.3）: 永続的記憶アーキテクチャ（短期・中期・長期）
- セクション4.5: ユーザープロファイル管理
- セクション5: スレッド構造と判定
- セクション8: 知識ベース（RAG層）全体
  - 8.1: エンターテインメント・趣味カテゴリ
  - 8.2: SQLite実装による独立DB管理
  - 8.3: カスタム知識ベース
  - 8.4: クロスカテゴリリンクシステム
- セクション18.9: データベース設計最適化（SQLite一本化）
- セクション10: ストレージポリシー（記憶関連部分）
- セクション18.3: 記憶の重要度判定（Memory Salience）

---

### ファイル2: 会話LLM_キャラクター仕様.md（400行）
**保存先:** `docks/仕様書/会話LLM_キャラクター仕様.md`  
**ステータス:** ⏳ 未作成

**含まれるセクション:**
- セクション3: キャラクター仕様
  - 3.1: 標準キャラクター（ルミナ・クラリス・ノクス）
  - 3.2: カスタムキャラクター追加機能
  - 3.3: キャラクター成長システム
- セクション6: 会話ルーティング仕様
- セクション7: ユーザー沈黙時の自走
- セクション9: KPIとキャラ成長
- セクション18.6: ペルソナの一貫性

**新規追加予定:**
- キャラクター管理API
- 指名構文詳細

---

### ファイル3: 会話LLM_感情・対話仕様.md（500行）
**保存先:** `docks/仕様書/会話LLM_感情・対話仕様.md`  
**ステータス:** ⏳ 未作成

**含まれるセクション:**
- セクション18.1: 感情モデル（Plutchikの8基本感情）
- セクション18.2: 対話スタイルの動的調整
- セクション18.4: 自己省察（Self-Reflection）
- セクション18.5: 対話の一貫性（Dialogue Coherence）
- セクション18.7: 待ち時間の自然な埋め方
- セクション18.8: トピック追跡とスムーズな転換

**新規追加予定:**
- 感情システム概要
- 対話品質管理

---

### ファイル4: 会話LLM_連想記憶仕様.md（450行）
**保存先:** `docks/仕様書/会話LLM_連想記憶仕様.md`  
**ステータス:** ⏳ 未作成

**含まれるセクション:**
- セクション4.4.1: 連想記憶の構造（Neo4j/SQLite Graph）
- セクション4.4.2: 連想記憶の活用例
- セクション4.4.3: 連想記憶の学習メカニズム
- セクション4.4.4: 連想記憶による高度な機能

**新規追加予定:**
- 連想記憶概要
- SQLite Graph実装（軽量版）
- パフォーマンス最適化

---

### ファイル5: 会話LLM_3D可視化仕様.md（350行）
**保存先:** `docks/仕様書/会話LLM_3D可視化仕様.md`  
**ステータス:** ⏳ 未作成

**含まれるセクション:**
- セクション4.4.5: 連想ネットワーク3D可視化（全サブセクション）
  - 4.4.5.1: 可視化パネルの仕様
  - 4.4.5.2: UIコントロール
  - 4.4.5.3: 自動更新モード
  - 4.4.5.4: 使用例
  - 4.4.5.5: パフォーマンス最適化
  - 4.4.5.6: UI配置

**新規追加予定:**
- 可視化システム概要
- Plotly.js設定詳細
- エクスポート機能拡張

---

## 3. ベースファイル（会話LLM_仕様.md）の整理

**整理後の想定行数:** 約500行  
**ステータス:** ⏳ 未実施

**残すセクション:**
- ✅ セクション1: プロジェクト概要（完全保持）
- ✅ セクション2: アーキテクチャ全体像（完全保持）
- ✅ セクション3-9: **概要のみ + 詳細ファイルへのリンク**
- ✅ セクション10-17: ストレージ・セキュリティ・ロードマップ等（完全保持）
- ✅ セクション19-21: 目的・実装例・一般機能（完全保持）
- ✅ セクション22-24: API・MCP・自律サーチ（完全保持）

**新規追加予定:**
- 分割ファイル一覧と説明
- ドキュメント構成ガイド

---

## 4. ファイル間のリンク構造

```
会話LLM_仕様.md（親文書・500行）
├── 会話LLM_記憶システム仕様.md（700行）✅
├── 会話LLM_キャラクター仕様.md（400行）⏳
├── 会話LLM_感情・対話仕様.md（500行）⏳
├── 会話LLM_連想記憶仕様.md（450行）⏳
└── 会話LLM_3D可視化仕様.md（350行）⏳

合計: 2,900行（元850行から拡張・整理）
```

---

## 5. 次のステップ（新スレッドで実施）

### Step 1: 残り4ファイルの作成
1. 会話LLM_キャラクター仕様.md
2. 会話LLM_感情・対話仕様.md
3. 会話LLM_連想記憶仕様.md
4. 会話LLM_3D可視化仕様.md

### Step 2: ベースファイルの整理
- 元の会話LLM_仕様.mdから詳細セクションを削除
- 各セクションに分割ファイルへのリンクを追加
- 分割ファイル一覧セクションを追加

### Step 3: 動作確認
- 各ファイルのリンクが正しく機能するか確認
- 内容の重複・欠落がないか確認

---

## 6. 重要な注意事項

1. **元ファイルは約850行**（3,471行表示は誤り）
2. **バージョン3.1.0**（API・MCP・自律サーチ対応版）
3. **各ファイルにはクロスリファレンスを追加**
4. **親文書から詳細へのリンクを明記**
5. **各ファイルの末尾に「親文書」「関連文書」リンクを記載**

---

## 7. 作成済みファイルの確認

**ファイル1（作成済み）:**
- パス: `docks/仕様書/会話LLM_記憶システム仕様.md`
- 内容: 記憶システム（短期・中期・長期・知識ベース）
- 注意: このファイルは簡略版として作成済み。完全版への更新が必要な場合は新スレッドで対応。

---

**このメモリを使って新スレッドで作業を継続してください。**
